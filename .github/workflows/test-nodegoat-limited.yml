name: Test RSOLV on Nodegoat (Limited Issues)

on:
  workflow_dispatch:
  push:
    branches:
      - feature/test-aware-fix-validation

jobs:
  test-rsolv-limited:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          submodules: false

      - name: Test RSOLV Action v3.7.28 on Nodegoat (Limited to 2 Issues)
        uses: RSOLV-dev/rsolv-action@v3.7.28
        with:
          rsolvApiKey: ${{ secrets.RSOLV_API_KEY }}
          # Limit to 2 issues to avoid long runs
          max_issues: '2'
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          RSOLV_DEBUG_CONVERSATION: "true"
          RSOLV_DEBUG: "true"
          RSOLV_TESTING_MODE: "true"
          AI_PROVIDER: "claude-code"
          USE_VENDED_CREDENTIALS: "true"
          TARGET_REPOSITORY: "RSOLV-dev/nodegoat-vulnerability-demo"