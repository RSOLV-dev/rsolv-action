# RSOLV Platform Environment Configuration
# Copy this file to .env and update with your actual values
# For quick setup, run: mix dev.env.setup

# ============================================================================
# REQUIRED: Database Configuration
# ============================================================================
# PostgreSQL connection string
# For local development with default PostgreSQL:
DATABASE_URL=postgresql://postgres:postgres@localhost/rsolv_dev

# Database SSL configuration
# Set to "false" for local development, "true" for production
DATABASE_SSL=false

# Connection pool size (default: 10)
POOL_SIZE=10

# ============================================================================
# REQUIRED: Application Secrets
# ============================================================================
# Phoenix secret key base (generate with: mix phx.gen.secret)
# MUST be at least 64 characters
SECRET_KEY_BASE=your_secret_key_base_here_at_least_64_characters_long_please_generate_with_mix_phx_gen_secret

# LiveView signing salt (optional, will use default if not set)
# LIVE_VIEW_SALT=GGUv7IyC34psVAUL2345

# ============================================================================
# REQUIRED: Application Configuration
# ============================================================================
# Host for the Phoenix endpoint
PHX_HOST=localhost

# HTTP port for the Phoenix server
PORT=4000

# ============================================================================
# OPTIONAL: AI Provider API Keys
# ============================================================================
# At least one AI provider key is required for full functionality
# Get your API keys from:

# Anthropic Claude API
# Sign up: https://console.anthropic.com/
ANTHROPIC_API_KEY=

# OpenAI API
# Sign up: https://platform.openai.com/api-keys
OPENAI_API_KEY=

# OpenRouter API (alternative AI provider)
# Sign up: https://openrouter.ai/keys
OPENROUTER_API_KEY=

# Ollama (local LLM server)
# Base URL if running Ollama locally
OLLAMA_BASE_URL=

# ============================================================================
# OPTIONAL: Email Configuration (Postmark)
# ============================================================================
# Postmark API key for transactional emails
# Sign up: https://postmarkapp.com/
POSTMARK_API_KEY=

# ============================================================================
# OPTIONAL: ConvertKit Integration
# ============================================================================
# ConvertKit API configuration for email marketing
# Sign up: https://convertkit.com/
KIT_API_KEY=
KIT_API_URL=https://api.convertkit.com/v3
KIT_FORM_ID=
KIT_EA_TAG_ID=

# ============================================================================
# OPTIONAL: Admin Dashboard Authentication
# ============================================================================
# Comma-separated list of admin email addresses for notifications
ADMIN_EMAILS=

# Admin credentials for LiveDashboard access
ADMIN_USERNAME=admin
ADMIN_PASSWORD=

# ============================================================================
# OPTIONAL: Error Tracking (Sentry)
# ============================================================================
# Sentry DSN for error tracking
# Sign up: https://sentry.io/
SENTRY_DSN=
SENTRY_ENV=development

# ============================================================================
# OPTIONAL: Monitoring (Prometheus/PromEx)
# ============================================================================
# Enable Prometheus metrics collection (default: true)
ENABLE_PROMETHEUS_METRICS=true

# ============================================================================
# OPTIONAL: Stripe Billing Integration (RFC-066)
# ============================================================================
# Stripe API key (test key for development, live key for production)
# Get your keys: https://dashboard.stripe.com/apikeys
# NOTE: Use test keys (sk_test_...) for development/staging
# NOTE: Use live keys (sk_live_...) for production ONLY - NEVER commit to git
# Example test key format: sk_test_51AbCdEfGhIjKlMnOpQrStUvWxYz
STRIPE_API_KEY=

# Stripe webhook signing secret for webhook verification (format: whsec_...)
# ⚠️ CRITICAL: Required for Pro subscriptions to work in production
# WITHOUT THIS: Customers pay $599 but receive 0 credits (should get 60)
#
# Setup steps (Production/Staging):
# 1. Go to: https://dashboard.stripe.com/webhooks
# 2. Add endpoint: https://api.rsolv.dev/api/webhooks/stripe (production)
#                  https://api.rsolv-staging.com/api/webhooks/stripe (staging)
# 3. Select events: invoice.payment_succeeded, invoice.payment_failed,
#                   customer.subscription.created/updated/deleted
# 4. Copy the signing secret (starts with whsec_...)
#
# Setup steps (Local Development with Tailscale):
# 1. Start Tailscale Funnel: tailscale funnel 4000
# 2. Go to: https://dashboard.stripe.com/test/webhooks
# 3. Add endpoint: https://your-machine.your-tailnet.ts.net/api/webhooks/stripe
# 4. Select same events as above
# 5. Copy the signing secret
# See: docs/STRIPE-WEBHOOK-TESTING.md for complete local testing guide
#
# For Kubernetes deployment, add to secrets instead:
#   kubectl create secret generic rsolv-secrets \
#     --from-literal=STRIPE_WEBHOOK_SECRET=whsec_... \
#     -n rsolv-production
#
# See: RFC-066 "Webhook Configuration" section for full details
# See: VK tasks ed10776b-524f-4a62-9c3a-413433adfb9d (config) and
#               1376b937-1f28-4d27-b026-f12ec7f9a782 (testing)
STRIPE_WEBHOOK_SECRET=

# Stripe Pro subscription configuration
# Price ID for the Pro monthly subscription ($599/month with 60 credits)
#
# PROGRAMMATIC LOOKUP (Recommended):
#   The price is created with lookup_key "pro_monthly" in Stripe.
#   To get the actual price ID programmatically:
#
#   export STRIPE_PRO_PRICE_ID=$(mix stripe.get_price pro_monthly)
#
#   This works across test/production because lookup_keys are stable.
#   Much better than manual lookup in the Stripe dashboard!
#
# Test mode default: price_0SPvUw7pIu1KP146qVYwNTQ8
# Production: Run the command above with your production STRIPE_API_KEY
STRIPE_PRO_PRICE_ID=price_0SPvUw7pIu1KP146qVYwNTQ8

# Number of credits to grant for Pro subscription payments
# Default: 60 credits per month
STRIPE_PRO_CREDITS=60

# ============================================================================
# OPTIONAL: Kubernetes Clustering (Production Only)
# ============================================================================
# These are only needed when deploying to Kubernetes
# RELEASE_NODE=rsolv
# POD_NAME=
# POD_NAMESPACE=default
# CLUSTER_SERVICE_NAME=staging-rsolv-platform-headless
