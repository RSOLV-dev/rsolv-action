[
  {
    "id": "typescript-non-null-assertion",
    "name": "TypeScript Non-Null Assertion",
    "description": "Detects unsafe non-null assertions that may cause runtime errors",
    "type": "null_pointer_dereference",
    "severity": "medium",
    "cweId": "CWE-476",
    "owaspCategory": "A04:2021 - Insecure Design",
    "remediation": "Use proper null checks instead of non-null assertions",
    "confidence": "medium",
    "regex_patterns": [
      "\\w+!\\.(?!length|toString|valueOf)"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nconst name = user!.name;\n\n// Secure:\nconst name = user?.name ||",
    "tags": [
      "javascript",
      "severity-medium",
      "owasp-A04"
    ],
    "language": "javascript"
  },
  {
    "id": "graphql-introspection",
    "name": "GraphQL Introspection Enabled",
    "description": "Detects GraphQL introspection enabled in production",
    "type": "information_disclosure",
    "severity": "medium",
    "cweId": "CWE-200",
    "owaspCategory": "A01:2021 - Broken Access Control",
    "remediation": "Disable GraphQL introspection in production environments",
    "confidence": "medium",
    "regex_patterns": [
      "introspection:\\s*true",
      "GraphQLSchema.*introspection:\\s*true"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nnew GraphQLServer({ schema, introspection: true });\n\n// Secure:\nnew GraphQLServer({ schema, introspection: process.env.NODE_ENV ===",
    "tags": [
      "javascript",
      "severity-medium",
      "owasp-A01"
    ],
    "language": "javascript"
  },
  {
    "id": "electron-node-integration",
    "name": "Electron Node Integration Enabled",
    "description": "Detects unsafe Electron configurations with Node integration",
    "type": "security_misconfiguration",
    "severity": "critical",
    "cweId": "CWE-829",
    "owaspCategory": "A05:2021 - Security Misconfiguration",
    "remediation": "Disable Node integration and enable context isolation",
    "confidence": "medium",
    "regex_patterns": [
      "nodeIntegration:\\s*true",
      "contextIsolation:\\s*false",
      "webSecurity:\\s*false"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nnew BrowserWindow({ webPreferences: { nodeIntegration: true } });\n\n// Secure:\nnew BrowserWindow({ webPreferences: { nodeIntegration: false, contextIsolation: true } });",
    "tags": [
      "javascript",
      "severity-critical",
      "owasp-A05"
    ],
    "language": "javascript"
  },
  {
    "id": "ruby-broken-access-control-missing-auth",
    "name": "Missing Authentication in Rails Controller",
    "description": "Detects Rails controllers without authentication filters",
    "type": "broken_access_control",
    "severity": "high",
    "cweId": "CWE-862",
    "owaspCategory": "A01:2021 - Broken Access Control",
    "remediation": "Add before_action :authenticate_user! to protect sensitive actions",
    "confidence": "medium",
    "regex_patterns": [
      "class\\s+\\w+Controller\\s*<\\s*ApplicationController(?:(?!before_action|before_filter|authenticate).)*end",
      "def\\s+(admin|delete|update|create)(?:(?!current_user|logged_in|authenticate).)*end"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nclass AdminController < ApplicationController\n  def users\n    @users = User.all\n  end\nend\n\n// Secure:\nclass AdminController < ApplicationController\n  before_action :authenticate_user!\n  before_action :require_admin\n  \n  def users\n    @users = User.all\n  end\nend",
    "tags": [
      "ruby",
      "severity-high",
      "owasp-A01"
    ],
    "language": "ruby"
  },
  {
    "id": "ruby-mass-assignment",
    "name": "Mass Assignment Vulnerability",
    "description": "Detects unfiltered params in model operations",
    "type": "mass_assignment",
    "severity": "high",
    "cweId": "CWE-915",
    "owaspCategory": "A01:2021 - Broken Access Control",
    "remediation": "Use strong parameters: params.require(:user).permit(:name, :email)",
    "confidence": "medium",
    "regex_patterns": [
      "\\.(create|update|update_attributes|assign_attributes)\\s*\\(\\s*params(?!\\s*\\.\\s*(require|permit))",
      "User\\.new\\s*\\(\\s*params\\["
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nUser.create(params[:user])\n\n// Secure:\nUser.create(user_params) # with private user_params method using permit()",
    "tags": [
      "ruby",
      "severity-high",
      "owasp-A01"
    ],
    "language": "ruby"
  },
  {
    "id": "ruby-weak-crypto-md5",
    "name": "Weak Cryptography - MD5",
    "description": "MD5 is cryptographically broken and should not be used",
    "type": "weak_cryptography",
    "severity": "medium",
    "cweId": "CWE-327",
    "owaspCategory": "A02:2021 - Cryptographic Failures",
    "remediation": "Use SHA-256 or SHA-3: Digest::SHA256.hexdigest(data)",
    "confidence": "medium",
    "regex_patterns": [
      "Digest::MD5",
      "OpenSSL::Digest::MD5",
      "\\.md5\\("
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\npassword_hash = Digest::MD5.hexdigest(password)\n\n// Secure:\npassword_hash = BCrypt::Password.create(password)",
    "tags": [
      "ruby",
      "severity-medium",
      "owasp-A02"
    ],
    "language": "ruby"
  },
  {
    "id": "ruby-weak-random",
    "name": "Weak Random Number Generation",
    "description": "Using predictable random number generation",
    "type": "weak_cryptography",
    "severity": "medium",
    "cweId": "CWE-330",
    "owaspCategory": "A04:2021 - Insecure Design",
    "remediation": "Use SecureRandom for security-sensitive randomness",
    "confidence": "medium",
    "regex_patterns": [
      "\\brand\\s*\\(",
      "Random\\.rand(?!\\s*\\(\\s*SecureRandom)",
      "\\bsrand\\s*\\("
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\ntoken = rand(1000000)\n\n// Secure:\ntoken = SecureRandom.hex(16)",
    "tags": [
      "ruby",
      "severity-medium",
      "owasp-A04"
    ],
    "language": "ruby"
  },
  {
    "id": "ruby-debug-mode-enabled",
    "name": "Debug Mode Enabled",
    "description": "Debug mode exposes sensitive information",
    "type": "debug_mode",
    "severity": "medium",
    "cweId": "CWE-489",
    "owaspCategory": "A05:2021 - Security Misconfiguration",
    "remediation": "Remove debug statements and disable debug mode in production",
    "confidence": "medium",
    "regex_patterns": [
      "config\\.consider_all_requests_local\\s*=\\s*true",
      "\\bbyebug\\b",
      "\\bdebugger\\b",
      "binding\\.pry"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nconfig.consider_all_requests_local = true\n\n// Secure:\nconfig.consider_all_requests_local = false",
    "tags": [
      "ruby",
      "severity-medium",
      "owasp-A05"
    ],
    "language": "ruby"
  },
  {
    "id": "ruby-eval-usage",
    "name": "Use of eval()",
    "description": "eval() can execute arbitrary code",
    "type": "vulnerable_components",
    "severity": "high",
    "cweId": "CWE-95",
    "owaspCategory": "A06:2021 - Vulnerable and Outdated Components",
    "remediation": "Avoid eval() or validate/sanitize input thoroughly",
    "confidence": "medium",
    "regex_patterns": [
      "\\beval\\s*\\(",
      "instance_eval",
      "class_eval",
      "module_eval"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\neval(user_input)\n\n// Secure:\nsend(method_name) if allowed_methods.include?(method_name)",
    "tags": [
      "ruby",
      "severity-high",
      "owasp-A06"
    ],
    "language": "ruby"
  },
  {
    "id": "ruby-weak-password-storage",
    "name": "Weak Password Storage",
    "description": "Passwords stored without proper hashing",
    "type": "broken_authentication",
    "severity": "critical",
    "cweId": "CWE-256",
    "owaspCategory": "A07:2021 - Identification and Authentication Failures",
    "remediation": "Use BCrypt for password hashing",
    "confidence": "medium",
    "regex_patterns": [
      "password\\s*=\\s*Digest::(MD5|SHA1)",
      "user\\.password\\s*=\\s*params",
      "password.*?\\.downcase(?!.*bcrypt)"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nuser.password = Digest::SHA1.hexdigest(params[:password])\n\n// Secure:\nuser.password = BCrypt::Password.create(params[:password])",
    "tags": [
      "ruby",
      "severity-critical",
      "owasp-A07"
    ],
    "language": "ruby"
  },
  {
    "id": "ruby-unsafe-deserialization-marshal",
    "name": "Unsafe Deserialization with Marshal",
    "description": "Marshal.load can execute arbitrary code",
    "type": "insecure_deserialization",
    "severity": "critical",
    "cweId": "CWE-502",
    "owaspCategory": "A08:2021 - Software and Data Integrity Failures",
    "remediation": "Use JSON or MessagePack for serialization",
    "confidence": "medium",
    "regex_patterns": [
      "Marshal\\.load",
      "Marshal\\.restore"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\ndata = Marshal.load(user_input)\n\n// Secure:\ndata = JSON.parse(user_input)",
    "tags": [
      "ruby",
      "severity-critical",
      "owasp-A08"
    ],
    "language": "ruby"
  },
  {
    "id": "ruby-unsafe-yaml",
    "name": "Unsafe YAML Loading",
    "description": "YAML.load can execute arbitrary code",
    "type": "insecure_deserialization",
    "severity": "high",
    "cweId": "CWE-502",
    "owaspCategory": "A08:2021 - Software and Data Integrity Failures",
    "remediation": "Use YAML.safe_load for untrusted input",
    "confidence": "medium",
    "regex_patterns": [
      "YAML\\.load(?!_file|_stream)",
      "Psych\\.load(?!_file|_stream)"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nconfig = YAML.load(user_input)\n\n// Secure:\nconfig = YAML.safe_load(user_input)",
    "tags": [
      "ruby",
      "severity-high",
      "owasp-A08"
    ],
    "language": "ruby"
  },
  {
    "id": "ruby-insufficient-logging",
    "name": "Insufficient Security Logging",
    "description": "Missing logging for security-relevant events",
    "type": "insufficient_logging",
    "severity": "low",
    "cweId": "CWE-778",
    "owaspCategory": "A09:2021 - Security Logging and Monitoring Failures",
    "remediation": "Log security events and errors appropriately",
    "confidence": "medium",
    "regex_patterns": [
      "rescue\\s*(?:Exception|StandardError)?\\s*(?:=>)?\\s*\\w*\\s*\\n\\s*end",
      "rescue\\s*\\n\\s*nil\\s*\\n\\s*end"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nrescue => e\n  nil\nend\n\n// Secure:\nrescue => e\n  Rails.logger.error",
    "tags": [
      "ruby",
      "severity-low",
      "owasp-A09"
    ],
    "language": "ruby"
  },
  {
    "id": "ruby-ssrf-open-uri",
    "name": "SSRF via open-uri",
    "description": "Unvalidated URLs in open() can lead to SSRF",
    "type": "open_redirect",
    "severity": "high",
    "cweId": "CWE-918",
    "owaspCategory": "A10:2021 - Server-Side Request Forgery",
    "remediation": "Validate URLs against allowlist before making requests",
    "confidence": "medium",
    "regex_patterns": [
      "open\\s*\\(\\s*params",
      "URI\\.open\\s*\\(\\s*params",
      "Net::HTTP\\.get.*params"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\ndata = open(params[:url]).read\n\n// Secure:\ndata = open(validate_url(params[:url])).read",
    "tags": [
      "ruby",
      "severity-high",
      "owasp-A10"
    ],
    "language": "ruby"
  },
  {
    "id": "ruby-xss-erb-raw",
    "name": "XSS in ERB Templates",
    "description": "Using raw() or html_safe without sanitization",
    "type": "xss",
    "severity": "medium",
    "cweId": "CWE-79",
    "owaspCategory": "A03:2021 - Injection",
    "remediation": "Use Rails sanitize helpers or escape output by default",
    "confidence": "medium",
    "regex_patterns": [
      "<%=\\s*raw\\s+",
      "\\.html_safe(?!.*sanitize)",
      "<%==\\s*\\w+"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\n<%= raw user_content %>\n\n// Secure:\n<%= sanitize user_content %>",
    "tags": [
      "ruby",
      "severity-medium",
      "owasp-A03"
    ],
    "language": "ruby"
  },
  {
    "id": "ruby-open-redirect",
    "name": "Open Redirect",
    "description": "Unvalidated redirects can lead to phishing",
    "type": "open_redirect",
    "severity": "medium",
    "cweId": "CWE-601",
    "owaspCategory": "A01:2021 - Broken Access Control",
    "remediation": "Validate redirect URLs against an allowlist",
    "confidence": "medium",
    "regex_patterns": [
      "redirect_to\\s+params",
      "redirect_to\\s+request\\.(referrer|referer)"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nredirect_to params[:return_to]\n\n// Secure:\nredirect_to safe_redirect_path(params[:return_to]) || root_path",
    "tags": [
      "ruby",
      "severity-medium",
      "owasp-A01"
    ],
    "language": "ruby"
  },
  {
    "id": "elixir-weak-crypto-hash",
    "name": "Weak Password Hashing in Elixir",
    "description": "Detects use of weak hashing algorithms for passwords",
    "type": "broken_authentication",
    "severity": "high",
    "cweId": "CWE-916",
    "owaspCategory": "A07:2021 - Identification and Authentication Failures",
    "remediation": "Use Bcrypt, Argon2, or Pbkdf2 with appropriate cost factors in Elixir. For Bcrypt, use at least 12 rounds with the bcrypt_elixir library",
    "confidence": "medium",
    "regex_patterns": [
      ":crypto\\.hash\\s*\\(\\s*:(?:md5|sha|sha1|sha256)\\s*,",
      "Base\\.encode\\d+\\s*\\(\\s*:crypto\\.hash\\s*\\(\\s*:(?:md5|sha|sha1|sha256)\\s*,"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\n:crypto.hash(:md5, password)\n\n// Secure:\nBcrypt.hash_pwd_salt(password, log_rounds: 12)",
    "tags": [
      "elixir",
      "severity-high",
      "owasp-A07"
    ],
    "language": "elixir"
  },
  {
    "id": "elixir-unsafe-atom-creation",
    "name": "Unsafe Atom Creation",
    "description": "Detects dynamic atom creation from user input which can lead to memory exhaustion",
    "type": "insecure_deserialization",
    "severity": "medium",
    "cweId": "CWE-502",
    "owaspCategory": "A08:2021 - Software and Data Integrity Failures",
    "remediation": "Use Elixir\\",
    "confidence": "medium",
    "regex_patterns": [
      "String\\.to_atom\\s*\\("
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nString.to_atom(user_input)\n\n// Secure:\nString.to_existing_atom(user_input)",
    "tags": [
      "elixir",
      "severity-medium",
      "owasp-A08"
    ],
    "language": "elixir"
  },
  {
    "id": "elixir-code-evaluation",
    "name": "Unsafe Code Evaluation",
    "description": "Detects dynamic code evaluation vulnerabilities",
    "type": "insecure_deserialization",
    "severity": "critical",
    "cweId": "CWE-94",
    "owaspCategory": "A08:2021 - Software and Data Integrity Failures",
    "remediation": "Avoid dynamic code evaluation in Elixir. If necessary, strictly validate and sandbox the execution using proper Elixir patterns",
    "confidence": "medium",
    "regex_patterns": [
      "Code\\.eval_string\\s*\\(",
      "Code\\.eval_quoted\\s*\\("
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nCode.eval_string(user_input)\n\n// Secure:\ncase user_input do\\n",
    "tags": [
      "elixir",
      "severity-critical",
      "owasp-A08"
    ],
    "language": "elixir"
  },
  {
    "id": "elixir-weak-random",
    "name": "Weak Random Number Generation",
    "description": "Detects use of weak random number generators for security purposes",
    "type": "weak_cryptography",
    "severity": "medium",
    "cweId": "CWE-338",
    "owaspCategory": "A02:2021 - Cryptographic Failures",
    "remediation": "Use Elixir\\",
    "confidence": "medium",
    "regex_patterns": [
      ":rand\\.uniform\\s*\\(",
      "Enum\\.random\\s*\\(",
      ":random\\.uniform\\s*\\("
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\n:rand.uniform(1000000)\n\n// Secure:\n:crypto.strong_rand_bytes(4) |> :binary.decode_unsigned()",
    "tags": [
      "elixir",
      "severity-medium",
      "owasp-A02"
    ],
    "language": "elixir"
  },
  {
    "id": "elixir-xml-external-entities",
    "name": "XML External Entity Injection",
    "description": "Detects potential XXE vulnerabilities in XML parsing",
    "type": "xml_external_entities",
    "severity": "high",
    "cweId": "CWE-611",
    "owaspCategory": "A05:2021 - Security Misconfiguration",
    "remediation": "Disable external entity processing in Elixir XML parsers. Use SweetXml or other safe Elixir XML parsing libraries with XXE protection enabled by default",
    "confidence": "medium",
    "regex_patterns": [
      ":xmerl_scan\\.string\\s*\\("
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\n:xmerl_scan.string(xml_content)\n\n// Secure:\nSweetXml.parse(xml_content, dtd: :none)",
    "tags": [
      "elixir",
      "severity-high",
      "owasp-A05"
    ],
    "language": "elixir"
  },
  {
    "id": "elixir-vulnerable-components",
    "name": "Use of Vulnerable Dependencies",
    "description": "Detects potentially vulnerable Elixir/Erlang functions",
    "type": "vulnerable_components",
    "severity": "medium",
    "cweId": "CWE-1104",
    "owaspCategory": "A06:2021 - Vulnerable and Outdated Components",
    "remediation": "Use modern Elixir alternatives: System.monotonic_time instead of :erlang.now, :rand instead of :random, and always use safe option with binary_to_term",
    "confidence": "medium",
    "regex_patterns": [
      ":erlang\\.now\\s*\\(\\)",
      ":random\\."
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\n:erlang.now()\n\n// Secure:\nSystem.monotonic_time()",
    "tags": [
      "elixir",
      "severity-medium",
      "owasp-A06"
    ],
    "language": "elixir"
  },
  {
    "id": "rails-strong-parameters",
    "name": "Missing Strong Parameters",
    "description": "Rails controllers using params without permit() allowing mass assignment",
    "type": "mass_assignment",
    "severity": "high",
    "cweId": "CWE-915",
    "owaspCategory": "A01:2021 - Broken Access Control",
    "remediation": "Use strong parameters with permit(): params.require(:model).permit(:field1, :field2). Never use permit! in production.",
    "confidence": "medium",
    "regex_patterns": [
      "\\.(create|update|update_attributes|assign_attributes)\\s*\\(\\s*params(?!\\s*\\.\\s*(require|permit))",
      "User\\.new\\s*\\(\\s*params\\[",
      "\\.permit!\\s*\\)",
      "\\.(create!|update!)\\s*\\(\\s*params\\[",
      "\\.insert_all\\s*\\(\\s*params\\[",
      "\\.upsert_all\\s*\\(\\s*params\\["
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\ndef create\n  @user = User.create(params[:user])  # Mass assignment vulnerability\nend\n\n// Secure:\ndef create\n  @user = User.create(user_params)\nend\n\nprivate\n\ndef user_params\n  params.require(:user).permit(:name, :email)\nend",
    "tags": [
      "rails",
      "severity-high",
      "owasp-A01"
    ],
    "language": "rails"
  },
  {
    "id": "rails-erb-injection",
    "name": "ERB Template Injection",
    "description": "Server-side template injection through ERB evaluation with user input",
    "type": "template_injection",
    "severity": "critical",
    "cweId": "CWE-94",
    "owaspCategory": "A03:2021 - Injection",
    "remediation": "Never render user input as Rails ERB templates. Use static Rails templates with safe data binding and Rails helpers.",
    "confidence": "medium",
    "regex_patterns": [
      "ERB\\.new\\s*\\(\\s*params\\[",
      "ERB\\.new\\s*\\(\\s*user_template\\)"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nERB.new(params[:template]).result\n\n// Secure:\nrender template:",
    "tags": [
      "rails",
      "severity-critical",
      "owasp-A03"
    ],
    "language": "rails"
  },
  {
    "id": "rails-unsafe-route-constraints",
    "name": "Unsafe Route Constraints",
    "description": "Route constraints that can be bypassed or allow code execution",
    "type": "broken_access_control",
    "severity": "high",
    "cweId": "CWE-285",
    "owaspCategory": "A01:2021 - Broken Access Control",
    "remediation": "Use specific, restrictive regex patterns for Rails route constraints. Avoid dynamic constraints with user input in Rails routes.",
    "confidence": "medium",
    "regex_patterns": [
      "constraints:\\s*\\{\\s*\\w+:\\s*\\",
      "constraints:\\s*\\{\\s*\\w+:\\s*\\",
      ",\n        ",
      ",\n        ",
      ",\n        ",
      "\\.\\*"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nget \n\n// Secure:\nget",
    "tags": [
      "rails",
      "severity-high",
      "owasp-A01"
    ],
    "language": "rails"
  },
  {
    "id": "rails-insecure-session-config",
    "name": "Insecure Session Configuration",
    "description": "Rails session configuration without proper security flags",
    "type": "security_misconfiguration",
    "severity": "medium",
    "cweId": "CWE-614",
    "owaspCategory": "A05:2021 - Security Misconfiguration",
    "remediation": "Configure Rails sessions with secure: true, httponly: true, and same_site: :strict for HTTPS environments. Review Rails session store configuration.",
    "confidence": "medium",
    "regex_patterns": [
      "config\\.session_store.*?secure:\\s*false",
      "config\\.session_store.*?httponly:\\s*false",
      "config\\.session_store.*?same_site:\\s*:none",
      "config\\.session_store\\s*:cookie_store,\\s*key:",
      "Rails\\.application\\.config\\.session_store\\s*:cookie_store"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nconfig.session_store :cookie_store, key: \n\n// Secure:\nconfig.session_store :cookie_store, key:",
    "tags": [
      "rails",
      "severity-medium",
      "owasp-A05"
    ],
    "language": "rails"
  },
  {
    "id": "rails-dangerous-production-config",
    "name": "Dangerous Production Configuration",
    "description": "Development settings enabled in production environment",
    "type": "debug_mode",
    "severity": "medium",
    "cweId": "CWE-489",
    "owaspCategory": "A05:2021 - Security Misconfiguration",
    "remediation": "Ensure Rails production environment has consider_all_requests_local=false, debug gems removed, and proper Rails caching enabled",
    "confidence": "medium",
    "regex_patterns": [
      "config\\.consider_all_requests_local\\s*=\\s*true",
      "config\\.action_controller\\.perform_caching\\s*=\\s*false",
      "config\\.log_level\\s*=\\s*:debug",
      "config\\.eager_load\\s*=\\s*false",
      "config\\.cache_classes\\s*=\\s*false"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nconfig.consider_all_requests_local = true\n\n// Secure:\nconfig.consider_all_requests_local = Rails.env.development?",
    "tags": [
      "rails",
      "severity-medium",
      "owasp-A05"
    ],
    "language": "rails"
  },
  {
    "id": "rails-actionmailer-injection",
    "name": "ActionMailer Injection",
    "description": "Email header injection through ActionMailer with unvalidated input",
    "type": "template_injection",
    "severity": "high",
    "cweId": "CWE-117",
    "owaspCategory": "A03:2021 - Injection",
    "remediation": "Validate and sanitize email headers. Use address validation for email fields.",
    "confidence": "medium",
    "regex_patterns": [
      "mail\\s*\\(\\s*to:\\s*params\\["
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nmail(to: params[:email], subject: \n\n// Secure:\nmail(to: validate_email(params[:email]), subject:",
    "tags": [
      "rails",
      "severity-high",
      "owasp-A03"
    ],
    "language": "rails"
  },
  {
    "id": "rails-cve-2021-22880",
    "name": "CVE-2021-22880 - Open Redirect",
    "description": "Host header injection leading to open redirect vulnerability",
    "type": "open_redirect",
    "severity": "medium",
    "cweId": "CWE-601",
    "owaspCategory": "A01:2021 - Broken Access Control",
    "remediation": "Validate host headers against an allowlist before using in Rails redirects",
    "confidence": "medium",
    "regex_patterns": [
      "redirect_to\\s+request\\.protocol\\s*\\+\\s*request\\.host"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nredirect_to request.protocol + request.host + \n\n// Secure:\nredirect_to root_url +",
    "tags": [
      "rails",
      "severity-medium",
      "owasp-A01"
    ],
    "language": "rails"
  },
  {
    "id": "rails-cve-2020-8264",
    "name": "CVE-2020-8264 - Security Constraint Bypass",
    "description": "Bypass of security constraints through skip callback conditions",
    "type": "broken_access_control",
    "severity": "high",
    "cweId": "CWE-285",
    "owaspCategory": "A01:2021 - Broken Access Control",
    "remediation": "Never use user input in Rails skip callback conditions. Use safe, predefined conditions in Rails controllers.",
    "confidence": "medium",
    "regex_patterns": [
      "skip_before_action.*?if:\\s*->\\s*\\{.*?params\\[",
      "skip_around_action.*?if:\\s*params\\[",
      "skip_after_action.*?if:\\s*->\\s*\\{.*?eval\\s*\\("
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nskip_before_action :authenticate, if: -> { params[:skip] }\n\n// Secure:\nskip_before_action :authenticate, if: :public_action?",
    "tags": [
      "rails",
      "severity-high",
      "owasp-A01"
    ],
    "language": "rails"
  },
  {
    "id": "rails-cve-2019-5418",
    "name": "CVE-2019-5418 - File Content Disclosure",
    "description": "Path traversal vulnerability in render file allowing arbitrary file disclosure",
    "type": "path_traversal",
    "severity": "critical",
    "cweId": "CWE-22",
    "owaspCategory": "A01:2021 - Broken Access Control",
    "remediation": "Never use user input directly in Rails render file/template. Use predefined Rails templates or validate against allowlist.",
    "confidence": "medium",
    "regex_patterns": [
      "render\\s+file:\\s*params\\["
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nrender file: params[:template]\n\n// Secure:\nallowed = [",
    "tags": [
      "rails",
      "severity-critical",
      "owasp-A01"
    ],
    "language": "rails"
  },
  {
    "id": "django-template-xss",
    "name": "Django Template XSS",
    "description": "Cross-site scripting through unsafe Django template filters",
    "type": "xss",
    "severity": "medium",
    "cweId": "CWE-79",
    "owaspCategory": "A03:2021 - Injection",
    "remediation": "Use Django template automatic escaping or Django escape filter. Only use |safe with trusted, sanitized content in Django templates.",
    "confidence": "medium",
    "regex_patterns": [
      "\\{\\{\\s*\\w*\\w*content\\w*\\s*\\|\\s*safe\\s*\\}\\}",
      "\\{\\{\\s*.*?\\.body\\s*\\|\\s*safe\\s*\\}\\}",
      "mark_safe\\s*\\(\\s*user_\\w+"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\n{{ user_content|safe }}\n\n// Secure:\n{{ user_content }} or {{ user_content|escape }}",
    "tags": [
      "django",
      "severity-medium",
      "owasp-A03"
    ],
    "language": "django"
  },
  {
    "id": "django-debug-settings",
    "name": "Dangerous Django Debug Settings",
    "description": "Debug mode and development settings enabled in production",
    "type": "debug_mode",
    "severity": "high",
    "cweId": "CWE-489",
    "owaspCategory": "A05:2021 - Security Misconfiguration",
    "remediation": "Set Django DEBUG=False, configure Django ALLOWED_HOSTS, remove debug apps from Django INSTALLED_APPS, and use Django environment-specific settings",
    "confidence": "medium",
    "regex_patterns": [
      "DEBUG\\s*=\\s*True"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nDEBUG = True\\nALLOWED_HOSTS = []\n\n// Secure:\nDEBUG = False\\nALLOWED_HOSTS = [",
    "tags": [
      "django",
      "severity-high",
      "owasp-A05"
    ],
    "language": "django"
  },
  {
    "id": "django-insecure-session",
    "name": "Insecure Django Session Configuration",
    "description": "Django session and cookie settings without proper security flags",
    "type": "security_misconfiguration",
    "severity": "medium",
    "cweId": "CWE-614",
    "owaspCategory": "A05:2021 - Security Misconfiguration",
    "remediation": "Set Django session secure=True, httponly=True, and samesite=",
    "confidence": "medium",
    "regex_patterns": [
      "SESSION_COOKIE_SECURE\\s*=\\s*False",
      "SESSION_COOKIE_HTTPONLY\\s*=\\s*False",
      "SESSION_COOKIE_SAMESITE\\s*=\\s*None",
      "CSRF_COOKIE_SECURE\\s*=\\s*False",
      "CSRF_COOKIE_HTTPONLY\\s*=\\s*False",
      "SESSION_EXPIRE_AT_BROWSER_CLOSE\\s*=\\s*False",
      "SESSION_COOKIE_AGE\\s*=\\s*31536000",
      "SESSION_SAVE_EVERY_REQUEST\\s*=\\s*False"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nSESSION_COOKIE_SECURE = False\n\n// Secure:\nSESSION_COOKIE_SECURE = True\\nSESSION_COOKIE_HTTPONLY = True",
    "tags": [
      "django",
      "severity-medium",
      "owasp-A05"
    ],
    "language": "django"
  },
  {
    "id": "django-broken-auth",
    "name": "Django Broken Authentication",
    "description": "Weak authentication patterns and missing validation",
    "type": "broken_authentication",
    "severity": "high",
    "cweId": "CWE-287",
    "owaspCategory": "A07:2021 - Identification and Authentication Failures",
    "remediation": "Use Django built-in authentication system, require Django login decorators, implement Django password validators, avoid hardcoded credentials",
    "confidence": "medium",
    "regex_patterns": [
      "def\\s+\\w*admin\\w*.*?\\(.*?request.*?\\):(?!.*@login_required)(?!.*request\\.user\\.is_authenticated)"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nif user.password == password:\n\n// Secure:\nif user.check_password(password):",
    "tags": [
      "django",
      "severity-high",
      "owasp-A07"
    ],
    "language": "django"
  },
  {
    "id": "django-csrf-bypass",
    "name": "Django CSRF Protection Bypass",
    "description": "Cross-Site Request Forgery protection bypassed or disabled",
    "type": "csrf",
    "severity": "high",
    "cweId": "CWE-352",
    "owaspCategory": "A01:2021 - Broken Access Control",
    "remediation": "Remove Django @csrf_exempt from sensitive views, include Django {% csrf_token %} in forms, send CSRF token in AJAX requests using Django CSRF middleware",
    "confidence": "medium",
    "regex_patterns": [
      "@csrf_exempt\\s+def\\s+transfer_money",
      "@csrf_exempt\\s+def\\s+delete_account",
      "@csrf_exempt\\s+def\\s+change_password"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\n@csrf_exempt\\ndef transfer_money(request):\n\n// Secure:\ndef transfer_money(request):  # Uses CSRF protection by default",
    "tags": [
      "django",
      "severity-high",
      "owasp-A01"
    ],
    "language": "django"
  },
  {
    "id": "django-clickjacking",
    "name": "Django Clickjacking Vulnerability",
    "description": "Missing or disabled X-Frame-Options protection",
    "type": "security_misconfiguration",
    "severity": "medium",
    "cweId": "CWE-1021",
    "owaspCategory": "A05:2021 - Security Misconfiguration",
    "remediation": "Use Django X_FRAME_OPTIONS = ",
    "confidence": "medium",
    "regex_patterns": [
      "@xframe_options_exempt"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\n@xframe_options_exempt\\ndef sensitive_view(request):\n\n// Secure:\ndef sensitive_view(request):  # Uses X-Frame-Options by default",
    "tags": [
      "django",
      "severity-medium",
      "owasp-A05"
    ],
    "language": "django"
  },
  {
    "id": "django-mass-assignment",
    "name": "Django Mass Assignment",
    "description": "Mass assignment vulnerabilities in Django model operations",
    "type": "mass_assignment",
    "severity": "high",
    "cweId": "CWE-915",
    "owaspCategory": "A01:2021 - Broken Access Control",
    "remediation": "Use ModelForm with explicit fields, validate input, implement field whitelisting",
    "confidence": "medium",
    "regex_patterns": [
      "User\\.objects\\.create\\s*\\(\\s*\\*\\*\\s*request\\.POST\\s*\\)",
      "User\\s*\\(\\s*\\*\\*\\s*request\\.POST\\.dict\\(\\)\\s*\\)\\.save\\(\\)",
      "User\\.objects\\.bulk_create\\s*\\(\\s*\\[\\s*User\\s*\\(\\s*\\*\\*\\s*data\\s*\\)",
      "User\\.objects\\.filter\\s*\\(.*?\\)\\.update\\s*\\(\\s*\\*\\*\\s*request\\.POST\\s*\\)",
      "user\\.__dict__\\.update\\s*\\(\\s*request\\.POST\\s*\\)",
      "form\\s*=\\s*ModelForm\\s*\\(\\s*request\\.POST.*?instance\\s*=\\s*user\\s*\\)",
      "class\\s+\\w+Form\\s*\\(\\s*ModelForm\\s*\\):.*?class\\s+Meta:.*?model\\s*=\\s*\\w+(?!.*fields)"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nUser.objects.create(**request.POST)\n\n// Secure:\nUser.objects.create(name=request.POST[",
    "tags": [
      "django",
      "severity-high",
      "owasp-A01"
    ],
    "language": "django"
  },
  {
    "id": "django-cve-2021-33571",
    "name": "CVE-2021-33571 - URL Validation Bypass",
    "description": "URL validation bypass allowing open redirects",
    "type": "open_redirect",
    "severity": "medium",
    "cweId": "CWE-601",
    "owaspCategory": "A01:2021 - Broken Access Control",
    "remediation": "Validate redirect URLs against allowlist, sanitize URL schemes, use Django is_safe_url() for redirects",
    "confidence": "medium",
    "regex_patterns": [
      "URLValidator\\(\\)\\s*\\(\\s*user_\\w+"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nHttpResponseRedirect(request.GET[\n\n// Secure:\nfrom django.utils.http import is_safe_url\\nif is_safe_url(url, allowed_hosts={request.get_host()}):\\n    return HttpResponseRedirect(url)",
    "tags": [
      "django",
      "severity-medium",
      "owasp-A01"
    ],
    "language": "django"
  },
  {
    "id": "django-cve-2018-14574",
    "name": "CVE-2018-14574 - CommonMiddleware Open Redirect",
    "description": "Open redirect vulnerability in Django CommonMiddleware",
    "type": "open_redirect",
    "severity": "medium",
    "cweId": "CWE-601",
    "owaspCategory": "A01:2021 - Broken Access Control",
    "remediation": "Validate redirect URLs in Django, use absolute URLs instead of Django get_full_path(), implement URL allowlisting",
    "confidence": "medium",
    "regex_patterns": [
      "return\\s+HttpResponsePermanentRedirect\\s*\\(\\s*request\\.get_full_path\\(\\)\\s*\\)"
    ],
    "safe_usage_patterns": [],
    "example_code": "// Vulnerable:\nreturn HttpResponseRedirect(request.get_full_path())\n\n// Secure:\nreturn HttpResponseRedirect(",
    "tags": [
      "django",
      "severity-medium",
      "owasp-A01"
    ],
    "language": "django"
  }
]